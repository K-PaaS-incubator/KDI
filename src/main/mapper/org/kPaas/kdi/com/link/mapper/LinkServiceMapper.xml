<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.kPaas.kdi.main.link.mapper.LinkMapper">

	<insert id="createTable">
		CREATE TABLE `KDI_LINK_SERVICE` (
			`svc_id` numeric NOT NULL AUTO_INCREMENT,
			`ds_nm` varchar2(100) NOT NULL,
			`svc_nm` varchar2(100) NULL,
			`svc_type` char(1) NULL,
			`reg_id` varchar2(20) NULL,
			`reg_dt` date NULL,
			`mod_id` varchar2(20) NULL,
			`mod_dt` date NULL,
			PRIMARY KEY (`svc_id`)
		)
	</insert>	
		
	<select id="selectLinkList" resultType="org.kPaas.kdi.main.link.vo.LinkServiceVo">
		SELECT rownum as NUM,* FROM KDI_LINK_SERVICE
	</select>

	<select id="selectLinkListPage" parameterType="org.kPaas.kdi.main.link.vo.LinkServiceVo" resultType="org.kPaas.kdi.main.link.vo.LinkServiceVo">
		SELECT * FROM(SELECT ROWNUM AS NUM, * FROM KDI_LINK_SERVICE)
			WHERE NUM <![CDATA[>]]> (#{pageNum}-1) * #{amount}
			  AND NUM <![CDATA[<=]]> #{pageNum} * #{amount}
	</select>

	<select id="selectLinkListCount" resultType="Integer">
		SELECT count(*) as total FROM KDI_LINK_SERVICE;
	</select>
	
	<!-- 연계서비스 등록 시작 -->
	<select id="selectDsList" resultType="String">
		SELECT ds_nm FROM KDI_DATASOURCE
	</select>
	
	<select id="getSameLinkCheck" resultType="Integer">
		SELECT count(*) FROM KDI_LINK_SERVICE
		<where>svc_nm = #{svc_nm}</where>
	</select>
	
	<insert id="insertLink" parameterType="org.kPaas.kdi.main.link.vo.LinkServiceVo">
		INSERT INTO KDI_LINK_SERVICE(ds_nm,svc_nm,svc_type,reg_id,reg_dt,mod_id,mod_dt)
		VALUES(#{ds_nm},#{svc_nm},#{svc_type},#{reg_id},current_timestamp(),#{mod_id},current_timestamp())
	</insert>

</mapper>